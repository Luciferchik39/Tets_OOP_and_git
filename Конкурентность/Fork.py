"""
FORK –í PYTHON:
FORK –ù–ê WINDOWS:

‚ùå –ü—Ä—è–º–æ–≥–æ –∞–Ω–∞–ª–æ–≥–∞ os.fork() –ù–ï–¢
‚ùå –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ–ø–∏—Ä—É—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—è
‚ùå –ù–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (2‚Åø)

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π multiprocessing.Process (—ç—Ç–æ spawn)
‚úÖ –ü–µ—Ä–µ–¥–∞–≤–∞–π –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ args –∏–ª–∏ Queue
‚úÖ –î–ª—è fork-–ø–æ–≤–µ–¥–µ–Ω–∏—è - —Å—Ç–∞–≤—å WSL –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π Linux

–ì–õ–ê–í–ù–û–ï –û–¢–õ–ò–ß–ò–ï:
fork = "–∫–ª–æ–Ω–∏—Ä—É–π –º–µ–Ω—è –ø–æ–ª–Ω–æ—Å—Ç—å—é"
spawn = "–∑–∞–ø—É—Å—Ç–∏ –Ω–æ–≤—É—é –∫–æ–ø–∏—é —Å –Ω—É–ª—è"

‚Ä¢ fork() —Å–æ–∑–¥–∞–µ—Ç –ö–û–ü–ò–Æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —Ç–µ–∫—É—â–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
‚Ä¢ –û–±–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Å –û–î–ù–û–ì–û –ú–ï–°–¢–ê
‚Ä¢ N –≤—ã–∑–æ–≤–æ–≤ fork ‚Üí 2^N –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚Ä¢ –î–æ—á–µ—Ä–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç –≤–µ—Å—å –æ—Å—Ç–∞–≤—à–∏–π—Å—è –∫–æ–¥
‚Ä¢ –ù–∞ Windows –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–π multiprocessing)

–ü–æ—Å–ª–µ fork() —É —Ç–µ–±—è –µ—Å—Ç—å –î–í–ê –ü–†–û–¶–ï–°–°–ê, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û (–µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ —è–¥—Ä–∞)
–∏–ª–∏ –ö–û–ù–ö–£–†–ï–ù–¢–ù–û (–µ—Å–ª–∏ —è–¥—Ä–æ –æ–¥–Ω–æ, –Ω–æ –û–° –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É –Ω–∏–º–∏).

–î–ª—è –∫–æ–¥–∞ –Ω–∏–∂–µ
1. –£ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –°–í–û–ò –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã

# –†–∞–∑–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã - —Ä–∞–∑–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤ –ø–∞–º—è—Ç–∏!
proc_1: <generator at 0x0000021074A62330>
proc_2: <generator at 0x000001C603F82330>
—Ä–æ–¥–∏—Ç–µ–ª—å: <generator at 0x...>
2. –ü–æ—Ä—è–¥–æ–∫ –≤—ã–≤–æ–¥–∞ –Ω–µ —Ä–∞–≤–µ–Ω –ø–æ—Ä—è–¥–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
–¢–µ—Ä–º–∏–Ω–∞–ª –±—É—Ñ–µ—Ä–∏–∑–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥. –ü—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –Ω–æ –≤—ã–≤–æ–¥ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —Ç–µ—Ä–º–∏–Ω–∞–ª.

3. list(a) –∏—Å—á–µ—Ä–ø—ã–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä

list(a)  # –≤—ã–∑—ã–≤–∞–µ—Ç next() –ø–æ–∫–∞ –Ω–µ –∫–æ–Ω—á–∞—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã
# —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ:
result = []
for item in a:
    result.append(item)

    –ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥
–ö–æ–¥ —Ä–∞–±–æ—Ç–∞–ª –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ! –ü—Ä–æ—Å—Ç–æ:
–ü—Ä–æ—Ü–µ—Å—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ —Ä–µ—à–∞–µ—Ç, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—ã–≤–æ–¥–∏—Ç—å
–¢–µ—Ä–º–∏–Ω–∞–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Ü–µ–ª–∏–∫–æ–º, —Å–æ–∑–¥–∞–≤–∞—è –∏–ª–ª—é–∑–∏—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
–î–ª—è –Ω–∞—Å—Ç–æ—è—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π time.sleep() –∏ —Å–º–æ—Ç—Ä–∏ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏!
"""


import os
from multiprocessing import Process


# a = print(f"–Ω–∞—á–∏–Ω–∞—é —Ä–∞–±–æ—Ç—É –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ {os.getpid()}")
#
# def my_iterator(nums: int):
#     s = 0
#     while s < nums:
#         yield f'–≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–æ–∫—É, —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ s = {s + 1}'
#         print(f"üëà –í–µ—Ä–Ω—É–ª–∏—Å—å –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å–ª–µ yield {s}")
#         s += 1
#
#
# def new_work(name: str):
#     print(f'–¥–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å {name}, PID: {os.getpid()}, —Ä–æ–¥–∏—Ç–µ–ª—å {os.getppid()}')
#     a = my_iterator(5)
#     print(f'—Å–æ–∑–¥–∞–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é {a} –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ PID: {os.getpid()}')
#     next(a)
#
#
# def two_work(name:str):
#     print(f'–î–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å {name}, PID: {os.getpid()}, —Ä–æ–¥–∏—Ç–µ–ª—å {os.getppid()}')
#     a = my_iterator(5)
#     print(f'—Å–æ–∑–¥–∞–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é {a} –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ PID: {os.getpid()}')
#     print(list(a))
#
#
# if __name__ == "__main__":
#     print(f"–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID: {os.getpid()}")
#
#     # –°–æ–∑–¥–∞–µ–º –¥–æ—á–µ—Ä–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (–∞–Ω–∞–ª–æ–≥ fork)
#     # Process(target=—Ñ—É–Ω–∫—Ü–∏—è, args=–∫–æ—Ä—Ç–µ–∂_—Å_–∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏)
#     proc_1 = Process(target=new_work, args=('–ò–ª—å—è',))
#     print('–ü–µ—Ä–µ–º–µ–Ω–Ω–æ–π proc_1 –ø—Ä–∏—Å–≤–æ–∏–ª—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Process')
#     proc_2 = Process(target=two_work, args=('–ê–Ω–∞—Å–∏–∞—Å–∏—è',))
#     print('–ü–µ—Ä–µ–º–µ–Ω–Ω–æ–π proc_2 –ø—Ä–∏—Å–≤–æ–∏–ª—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Process')
#
#     proc_1.start()
#     # –ø—Ä–∏–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –ø—Ä–æ—Å—Ç–∞–Ω—Å—Ç–≤–µ
#     print(f"–∑–∞–ø—É—Å—Ç–∏–ª –ø–µ—Ä–≤—ã–π –ü—Ä–æ—Ü–µ—Å—Å –≤–æ—Ç —Ç–æ–ª—å–∫–æ –∫–∞–∫–æ–π –æ–Ω –¥–æ—á–µ—Ä–Ω–∏–π –∏–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π ? –ø—Ä–æ–≤–µ—Ä–∏–º PID {os.getpid()} == {os.getppid()} ?") # –ø—Ä–æ–≤–µ—Ä–∏–º PID 11960 == 392 ?
#
#     # print(f'–∑–∞—É–ø—Å—Ç–∏–ª my_iterator (–≤–æ–ø—Ä–æ—Å –≤ –∫–∞–∫–æ–º –ø—Ä–æ—Å—Ç–∞—Ä–Ω—Å—Ç–≤–µ? PID {os.getpid()}) (–≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º)' )
#     a = my_iterator(5)
#     next(a)
#     proc_2.start()
#     # print(f"–∑–∞–ø—É—Å—Ç–∏–ª –ø–µ—Ä–≤—ã–π –ü—Ä–æ—Ü–µ—Å—Å, –ø—Ä–æ–≤–µ—Ä–∏–º PID:{os.getpid()} –∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å: {os.getppid()} ?")
#     # print('–≤–æ –≤—Ç–æ—Ä–æ–º –¥–æ—á–µ—Ä–Ω–µ–º –ø—Ä–æ—Å—Ç–∞—Ä–∞–Ω—Å—Ç–≤–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –æ—Ç 1 –¥–æ 5')
#     print("—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –ø—Ä–æ—Å—Ç–∞—Ä–∞–Ω—Å–≤–æ –º—ã —É–∂–µ –∏—Å—á–µ—Ä—Ä–ø–∞–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä")
#     print(list(a))
#
#     proc_1.join()
#     proc_2.join()

a = print(f"–Ω–∞—á–∏–Ω–∞—é —Ä–∞–±–æ—Ç—É –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ {os.getpid()}")


def my_print():
    """–§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –¥–æ—á–µ—Ä–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö"""
    print(f"*** –°–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å PID: {os.getpid()}")


if __name__ == "__main__":
    print(f"üîµ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID: {os.getpid()}")

    num = int(input('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ–µ—Å–æ–≤: '))

    list_process = []
    for i in range(num):
        """
        –ó–ê–ü–û–ú–ù–ò:
    - –í target –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –ë–ï–ó —Å–∫–æ–±–æ–∫
    - –í args –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏
    - args –í–°–ï–ì–î–ê –∫–æ—Ä—Ç–µ–∂ (–¥–∞–∂–µ —Å –æ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º)
    - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ç–∞–≤—å –∫–∞–≤—ã—á–∫–∏ –≤–æ–∫—Ä—É–≥ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ target!
    """
        my_f_string = f'name--{i}'
        obj_Process = Process(target=my_print)
        list_process.append(obj_Process)
        obj_Process.start()
        print(f'‚û°Ô∏è –°–æ–∑–¥–∞–Ω –∏ –∑–∞–ø—É—â–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å {my_f_string} —Å PID: {obj_Process.pid}')


    for index, obj in enumerate(list_process):
        obj.join() # –¥–æ–∂–∏–¥–∞–µ–º—Å—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
        print(f'–ü—Ä–æ—Ü–µ—Å—Å {index} c PID: {obj.pid} –∑–∞–≤–µ—Ä—à—ë–Ω!')

    print("üèÅ –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!")

