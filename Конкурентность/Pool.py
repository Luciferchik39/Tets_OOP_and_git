import os
import time
import random
import multiprocessing
from datetime import datetime
from multiprocessing import Pool, Process, Queue

# =============================================================================
# –ß–ê–°–¢–¨ 1: –¢–ï–û–†–ò–Ø - –ß–¢–û –¢–ê–ö–û–ï POOL
# =============================================================================

"""
üî∞ POOL (–ü–£–õ –ü–†–û–¶–ï–°–°–û–í) - –û–°–ù–û–í–ù–´–ï –ü–û–ù–Ø–¢–ò–Ø
-------------------------------------------------------------------------------
Pool - —ç—Ç–æ –º–µ–Ω–µ–¥–∂–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤-–≤–æ—Ä–∫–µ—Ä–æ–≤
–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ–∂–¥—É –Ω–∏–º–∏ –∑–∞–¥–∞—á–∏. –ü—Ä–æ—Ü–µ—Å—Å—ã –∂–∏–≤—É—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
–¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∑–∞–¥–∞—á.

–ì–õ–ê–í–ù–ê–Ø –ò–î–ï–Ø:
    –û–¥–∏–Ω —Ä–∞–∑ —Å–æ–∑–¥–∞–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Üí –º–Ω–æ–≥–æ —Ä–∞–∑ –∏—Å–ø–æ–ª—å–∑—É–µ–º ‚Üí –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞–∫—Ä—ã–ª–∏

–£–î–û–ë–ù–ê–Ø –ê–ù–ê–õ–û–ì–ò–Ø:
    –í–º–µ—Å—Ç–æ 100 —á–µ–ª–æ–≤–µ–∫ —Å –ª–æ–ø–∞—Ç–∞–º–∏ (100 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö Process) –Ω–∞–Ω–∏–º–∞–µ–º 4 —á–µ–ª–æ–≤–µ–∫–∞ 
    —Å —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä–∞–º–∏ (Pool —Å 4 –≤–æ—Ä–∫–µ—Ä–∞–º–∏) –∏ —Å—Ç–∞–≤–∏–º –∏–º –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.
-------------------------------------------------------------------------------
"""

# =============================================================================
# –ß–ê–°–¢–¨ 2: –ö–û–ì–î–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ POOL
# =============================================================================

"""
‚úÖ –ò–î–ï–ê–õ–¨–ù–´–ï –°–¶–ï–ù–ê–†–ò–ò –î–õ–Ø POOL:
-------------------------------------------------------------------------------
1. –ú–Ω–æ–≥–æ –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –∑–∞–¥–∞—á (1000 —Ñ–∞–π–ª–æ–≤, 10000 URL)
   ‚Üí –û–¥–∏–Ω —Ä–∞–∑ —Å–æ–∑–¥–∞–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞—á

2. –ó–∞–¥–∞—á–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–Ω–æ–π –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ)
   ‚Üí –ú–æ–∂–Ω–æ —Å–º–µ–ª–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å

3. –•–æ—Ç–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É
   ‚Üí –ù–µ —Å–æ–∑–¥–∞–µ–º 1000 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∞ —Ç–æ–ª—å–∫–æ 4-8 (–ø–æ —á–∏—Å–ª—É —è–¥–µ—Ä)

4. –ü—Ä–æ—Ü–µ—Å—Å—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ–ª–≥–æ (–Ω–∞ Windows –æ—Å–æ–±–µ–Ω–Ω–æ)
   ‚Üí –°–æ–∑–¥–∞–ª–∏ –æ–¥–∏–Ω —Ä–∞–∑ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º

5. –ù—É–∂–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ –≤—ã–∑–æ–≤–∞
   ‚Üí map —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤

‚ùå –ö–û–ì–î–ê –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ POOL:
-------------------------------------------------------------------------------
- –ó–∞–¥–∞—á–∏ –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—á–µ—Ä–µ–¥–∏ (Queue/Pipe)
- –ù—É–∂–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ Process
- –í—Å–µ–≥–æ 2-3 –∑–∞–¥–∞—á–∏ ‚Üí –æ–≤–µ—Ä—Ö–µ–¥ –ø—É–ª–∞ –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–Ω
- –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∑–∞–¥–∞—á —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ ‚Üí –ø—Ä–æ—â–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
-------------------------------------------------------------------------------
"""


# =============================================================================
# –ß–ê–°–¢–¨ 3: –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–• –î–õ–Ø –ü–†–ò–ú–ï–†–û–í
# =============================================================================

def prepare_test_file(filename='file.txt', lines=100_000, digits_per_line=3):
    """
    –°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏.
    –ü–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–∞ —á–∏—Å–ª–æ.
    """
    print(f"üìÅ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ {filename} —Å {lines} —Å—Ç—Ä–æ–∫–∞–º–∏...")
    with open(filename, 'w') as f:
        for _ in range(lines):
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É –∏–∑ digits_per_line —Å–ª—É—á–∞–π–Ω—ã—Ö —Ü–∏—Ñ—Ä
            line = ''.join(str(random.randint(0, 9)) for _ in range(digits_per_line))
            f.write(f'{line}\n')
    print(f"‚úÖ –§–∞–π–ª {filename} –≥–æ—Ç–æ–≤")
    return filename


# =============================================================================
# –ß–ê–°–¢–¨ 4: –†–ê–ë–û–ß–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ü–†–ò–ú–ï–†–û–í
# =============================================================================

def laba(worker_id):
    """
    –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö.
    –ß–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –∏ —Å—É–º–º–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ.

    Args:
        worker_id: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–æ—Ä–∫–µ—Ä–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å —á–∏—Å–ª–æ–º –∏–ª–∏ —Å—Ç—Ä–æ–∫–æ–π)

    Returns:
        int: —Å—É–º–º–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
    """
    result = 0
    filename = 'file.txt'

    print(f"  üîß –í–æ—Ä–∫–µ—Ä {worker_id} (PID={os.getpid()}) –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É")
    start_time = time.time()

    try:
        with open(filename, 'r') as f:
            for i, s in enumerate(f):
                # –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ —á–∏—Å–ª–∞ –∏–∑ —Ñ–∞–π–ª–∞
                result += random.randint(0, int(s))

                # –ü—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 20 000 —Å—Ç—Ä–æ–∫ (—á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å)
                if i % 20000 == 0 and i > 0:
                    print(f"     –í–æ—Ä–∫–µ—Ä {worker_id}: –æ–±—Ä–∞–±–æ—Ç–∞–ª {i} —Å—Ç—Ä–æ–∫...")

    except Exception as e:
        print(f"  ‚ùå –í–æ—Ä–∫–µ—Ä {worker_id} –æ—à–∏–±–∫–∞: {e}")
        return 0

    elapsed = time.time() - start_time
    print(f"  ‚úÖ –í–æ—Ä–∫–µ—Ä {worker_id} (PID={os.getpid()}) –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ {elapsed:.2f} —Å–µ–∫, —Ä–µ–∑—É–ª—å—Ç–∞—Ç={result}")
    return result


# =============================================================================
# –ß–ê–°–¢–¨ 5: –†–ê–ó–õ–ò–ß–ù–´–ï –ú–ï–¢–û–î–´ POOL –° –ü–†–ò–ú–ï–†–ê–ú–ò
# =============================================================================

def demonstrate_map():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è pool.map - –ë–õ–û–ö–ò–†–£–Æ–©–ò–ô –º–µ—Ç–æ–¥.
    –ñ–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –í–°–ï–• –∑–∞–¥–∞—á –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –í –ü–û–†–Ø–î–ö–ï –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 1: pool.map() - –±–ª–æ–∫–∏—Ä—É—é—â–∏–π, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫")
    print("=" * 70)

    # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∞–π–ª, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
    prepare_test_file()

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")
    print("–°–æ–∑–¥–∞–µ–º –ø—É–ª –∏–∑ 4 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –∑–∞–ø—É—Å–∫–∞–µ–º 4 –∑–∞–¥–∞—á–∏...\n")

    start = datetime.now()

    # –°–æ–∑–¥–∞–µ–º –ø—É–ª –∏–∑ 4 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    with multiprocessing.Pool(4) as pool:
        """
        ‚ö†Ô∏è –í–ê–ñ–ù–û:
        map –ë–õ–û–ö–ò–†–£–ï–¢ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –í–°–ï–• –∑–∞–¥–∞—á.
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, —á—Ç–æ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (1,2,3,4)
        """
        results = pool.map(laba, (1, 2, 3, 4))

    elapsed = datetime.now() - start
    print(f"\nüìä –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: {results}")
    print(f"‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è: {elapsed}")
    print("\nüí° –ò–¢–û–ì: map –¥–æ–∂–¥–∞–ª—Å—è –≤—Å–µ—Ö –∏ –≤–µ—Ä–Ω—É–ª [res1, res2, res3, res4]")


def demonstrate_map_async():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è pool.map_async - –ù–ï–ë–õ–û–ö–ò–†–£–Æ–©–ò–ô –º–µ—Ç–æ–¥.
    –°—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–∑–∂–µ.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 2: pool.map_async() - –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç")
    print("=" * 70)

    prepare_test_file()

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")
    start = datetime.now()

    with multiprocessing.Pool(4) as pool:
        """
        ‚ö†Ô∏è –í–ê–ñ–ù–û:
        map_async –ù–ï –ë–õ–û–ö–ò–†–£–ï–¢ —Ä–æ–¥–∏—Ç–µ–ª—è. –°—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç AsyncResult.
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª—É—á–∞–µ–º —á–µ—Ä–µ–∑ .get(), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø–æ–¥–æ–∂–¥–∞—Ç—å.
        """
        print("\nüìå –ó–∞–ø—É—Å–∫–∞–µ–º map_async...")
        result_obj = pool.map_async(laba, (1, 2, 3, 4))

        print("üìå map_async —Å—Ä–∞–∑—É –≤–µ—Ä–Ω—É–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —Ä–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É")
        print("üìå –î–µ–ª–∞–µ–º —á—Ç–æ-—Ç–æ –µ—â–µ, –ø–æ–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç...")
        time.sleep(2)  # –ò–º–∏—Ç–∞—Ü–∏—è –¥—Ä—É–≥–æ–π —Ä–∞–±–æ—Ç—ã
        print("üìå –†–æ–¥–∏—Ç–µ–ª—å –ø–æ—Ä–∞–±–æ—Ç–∞–ª, —Ç–µ–ø–µ—Ä—å —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã")

        # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–º–æ–∂–µ—Ç –ø–æ–¥–æ–∂–¥–∞—Ç—å, –µ—Å–ª–∏ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤—ã)
        results = result_obj.get()
        print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã: {results}")

    elapsed = datetime.now() - start
    print(f"‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è: {elapsed}")
    print("\nüí° –ò–¢–û–ì: —Ä–æ–¥–∏—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–ª –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏")


def demonstrate_imap():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è pool.imap - –õ–ï–ù–ò–í–´–ô map.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ç–µ—Ä–∞—Ç–æ—Ä, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–¥–∞–µ—Ç –ü–û –ú–ï–†–ï –ì–û–¢–û–í–ù–û–°–¢–ò.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 3: pool.imap() - –ª–µ–Ω–∏–≤—ã–π, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–æ—Ä—è–¥–∫–∞)")
    print("=" * 70)

    prepare_test_file()

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")
    start = datetime.now()

    with multiprocessing.Pool(4) as pool:
        """
        ‚ö†Ô∏è –í–ê–ñ–ù–û:
        imap –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ò–¢–ï–†–ê–¢–û–†. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ –º–µ—Ä–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏,
        –ù–û –í –ü–û–†–Ø–î–ö–ï –ê–†–ì–£–ú–ï–ù–¢–û–í (–µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ 1 –¥–æ–ª–≥–∞—è - –∂–¥–µ–º –µ–µ).
        """
        print("\nüìå –ó–∞–ø—É—Å–∫–∞–µ–º imap...")
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–µ–ª–∞–µ–º —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
        args = [1, 2, 3, 4]  # –í–æ—Ä–∫–µ—Ä—ã —Å —Ä–∞–∑–Ω—ã–º–∏ ID

        for i, result in enumerate(pool.imap(laba, args)):
            print(f"üìä –ü–æ–ª—É—á–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç {i + 1}: {result}")

    elapsed = datetime.now() - start
    print(f"‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è: {elapsed}")
    print("\nüí° –ò–¢–û–ì: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏, –Ω–æ –∂–¥–µ–º –∫–∞–∂–¥—ã–π –ø–æ –ø–æ—Ä—è–¥–∫—É")


def demonstrate_imap_unordered():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è pool.imap_unordered.
    –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ü–û–†–Ø–î–ö–ï –ó–ê–í–ï–†–®–ï–ù–ò–Ø (–∫—Ç–æ –ø–µ—Ä–≤—ã–π —Å–¥–µ–ª–∞–ª - —Ç–æ–≥–æ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç).
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 4: pool.imap_unordered() - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
    print("=" * 70)

    prepare_test_file()

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")
    start = datetime.now()

    with multiprocessing.Pool(4) as pool:
        """
        ‚ö†Ô∏è –í–ê–ñ–ù–û:
        imap_unordered –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ,
        –≤ –∫–æ—Ç–æ—Ä–æ–º –∑–∞–¥–∞—á–∏ –ó–ê–í–ï–†–®–ê–Æ–¢–°–Ø, –∞ –Ω–µ –≤ –ø–æ—Ä—è–¥–∫–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.
        """
        print("\nüìå –ó–∞–ø—É—Å–∫–∞–µ–º imap_unordered...")
        args = [1, 2, 3, 4]

        results = []
        for result in pool.imap_unordered(laba, args):
            print(f"üìä –ü–æ–ª—É—á–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {result}")
            results.append(result)

    elapsed = datetime.now() - start
    print(f"\nüìä –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–≤ –ø–æ—Ä—è–¥–∫–µ –ø–æ–ª—É—á–µ–Ω–∏—è): {results}")
    print(f"‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è: {elapsed}")
    print("\nüí° –ò–¢–û–ì: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ –º–µ—Ä–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏, –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞")


def demonstrate_starmap():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è pool.starmap - –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π —Å –ù–ï–°–ö–û–õ–¨–ö–ò–ú–ò –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 5: pool.starmap() - –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏")
    print("=" * 70)

    def add(a, b, c):
        """–§—É–Ω–∫—Ü–∏—è —Å —Ç—Ä–µ–º—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏"""
        print(f"  ‚ûï –°–∫–ª–∞–¥—ã–≤–∞—é {a}+{b}+{c} –≤ PID={os.getpid()}")
        time.sleep(random.random())
        return a + b + c

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")

    with multiprocessing.Pool(4) as pool:
        """
        ‚ö†Ô∏è –í–ê–ñ–ù–û:
        starmap –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ö–û–†–¢–ï–ñ–ï–ô —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏.
        –ö–∞–∂–¥—ã–π –∫–æ—Ä—Ç–µ–∂ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏.
        """
        args = [(1, 2, 3), (4, 5, 6), (7, 8, 9), (10, 11, 12)]
        results = pool.starmap(add, args)

        print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {results}")

    print("\nüí° –ò–¢–û–ì: starmap —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂–∏ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏")


# =============================================================================
# –ß–ê–°–¢–¨ 6: –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–£–õ–û–ú (CLOSE/JOIN)
# =============================================================================

def demonstrate_pool_management():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—É–ª–æ–º (–±–µ–∑ with).
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 6: –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–ª–æ–º (close/join)")
    print("=" * 70)

    prepare_test_file()

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")

    # –°–æ–∑–¥–∞–µ–º –ø—É–ª –±–µ–∑ with
    pool = multiprocessing.Pool(4)

    print("üìå –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–¥–∞—á–∏...")
    result_async = pool.map_async(laba, (1, 2, 3))

    """
    ‚ö†Ô∏è –í–ê–ñ–ù–û –ü–†–û close() –ò join():

    close() - –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø—É–ª –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á. –ü–æ—Å–ª–µ close –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏.
    join() - –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –í–°–ï–• –≤–æ—Ä–∫–µ—Ä–æ–≤. –ë–µ–∑ join –ø—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –æ—Å—Ç–∞—Ç—å—Å—è –≤–∏—Å–µ—Ç—å.

    –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ with: close+join –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
    """
    print("üìå –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—É–ª –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (close)")
    pool.close()  # –ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º

    print("üìå –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ (join)")
    pool.join()  # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

    # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    results = result_async.get()
    print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {results}")

    print("\nüí° –ò–¢–û–ì: close+join –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç —á–∏—Å—Ç—É—é –æ—Å—Ç–∞–Ω–æ–≤–∫—É")


# =============================================================================
# –ß–ê–°–¢–¨ 7: CHUNK SIZE (–†–ê–ó–ú–ï–† –ü–û–†–¶–ò–ò)
# =============================================================================

def demonstrate_chunksize():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–ª–∏—è–Ω–∏—è chunksize –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 7: CHUNK SIZE - —Ä–∞–∑–º–µ—Ä –ø–æ—Ä—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö")
    print("=" * 70)

    def quick_task(x):
        """–ë—ã—Å—Ç—Ä–∞—è –∑–∞–¥–∞—á–∞ (–º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—ã)"""
        return x * x

    # –°–æ–∑–¥–∞–µ–º –º–Ω–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∑–∞–¥–∞—á
    data = list(range(10000))

    print("\nüìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å —Ä–∞–∑–Ω—ã–º chunksize:\n")

    # –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è chunksize (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    start = time.time()
    with Pool(4) as pool:
        results = pool.map(quick_task, data)
    default_time = time.time() - start
    print(f"  –ë–µ–∑ chunksize (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): {default_time:.3f} —Å–µ–∫")

    # –° chunksize=100
    start = time.time()
    with Pool(4) as pool:
        results = pool.map(quick_task, data, chunksize=100)
    chunksize_time = time.time() - start
    print(f"  –° chunksize=100: {chunksize_time:.3f} —Å–µ–∫")

    # –° chunksize=1000
    start = time.time()
    with Pool(4) as pool:
        results = pool.map(quick_task, data, chunksize=1000)
    chunksize_time2 = time.time() - start
    print(f"  –° chunksize=1000: {chunksize_time2:.3f} —Å–µ–∫")

    """
    üí° –ß–¢–û –¢–ê–ö–û–ï CHUNKSIZE:

    chunksize –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤–æ—Ä–∫–µ—Ä—É –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑.

    –ë–µ–∑ chunksize: –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –æ—Ç–¥–µ–ª—å–Ω–æ ‚Üí –º–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π –ø–µ—Ä–µ–¥–∞—á–∏
    –° chunksize=100: –ø–∞–∫–µ—Ç—ã –ø–æ 100 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚Üí –º–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤

    –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è:
    - –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–¥–∞—á (–Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –≤–µ–ª–∏–∫–∏)
    - –ë–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–¥–∞—á
    """
    print("\nüí° –í–´–í–û–î: –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–¥–∞—á chunksize –î–ê–ï–¢ –ü–†–ò–†–û–°–¢ —Å–∫–æ—Ä–æ—Å—Ç–∏")


# =============================================================================
# –ß–ê–°–¢–¨ 8: INITIALIZER - –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –í–û–†–ö–ï–†–û–í
# =============================================================================

def demonstrate_initializer():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è initializer - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 8: INITIALIZER - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ")
    print("=" * 70)

    # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –≤–æ—Ä–∫–µ—Ä–æ–≤ (–∫–∞–∂–¥—ã–π –ø–æ–ª—É—á–∏—Ç —Å–≤–æ—é –∫–æ–ø–∏—é)
    worker_data = {}

    def init_worker():
        """–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ö–ê–ñ–î–û–ú –≤–æ—Ä–∫–µ—Ä–µ –ø—Ä–∏ –µ–≥–æ –∑–∞–ø—É—Å–∫–µ"""
        global worker_data
        worker_data['pid'] = os.getpid()
        worker_data['start_time'] = time.time()
        print(f"  üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ—Ä–∫–µ—Ä–∞ PID={os.getpid()}, –¥–∞–Ω–Ω—ã–µ={worker_data}")

    def worker_task(x):
        """–ó–∞–¥–∞—á–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"""
        global worker_data
        print(f"  üì¶ –ó–∞–¥–∞—á–∞ {x} –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ PID={os.getpid()}, worker_data={worker_data}")
        return x * 2

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")

    """
    ‚ö†Ô∏è –í–ê–ñ–ù–û:
    initializer - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ö–ê–ñ–î–û–ú –≤–æ—Ä–∫–µ—Ä–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
    initargs - –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è initializer.

    –ü–æ–∑–≤–æ–ª—è–µ—Ç:
    - –û—Ç–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î
    - –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ
    - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã
    """
    with Pool(4, initializer=init_worker) as pool:
        results = pool.map(worker_task, range(8))

    print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {results}")
    print("\nüí° –ò–¢–û–ì: –∫–∞–∂–¥—ã–π –≤–æ—Ä–∫–µ—Ä –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏")


# =============================================================================
# –ß–ê–°–¢–¨ 9: –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö
# =============================================================================

def demonstrate_error_handling():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ Pool.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 9: –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö –≤ Pool")
    print("=" * 70)

    def faulty_function(x):
        """–§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å"""
        if x == 3:
            raise ValueError(f"–û—à–∏–±–∫–∞! x={x}")
        print(f"  ‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω x={x} –≤ PID={os.getpid()}")
        time.sleep(1)
        return x * 2

    print(f"\nüöÄ –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å PID={os.getpid()}")

    # –ü—Ä–∏–º–µ—Ä —Å map (–æ—à–∏–±–∫–∞ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É)
    print("\nüìå map —Å –æ—à–∏–±–∫–æ–π:")
    try:
        with Pool(4) as pool:
            results = pool.map(faulty_function, [1, 2, 3, 4, 5])
        print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {results}")
    except Exception as e:
        print(f"  ‚ùå –ü–æ–π–º–∞–ª–∏ –æ—à–∏–±–∫—É: {type(e).__name__}: {e}")

    # –ü—Ä–∏–º–µ—Ä —Å map_async (–æ—à–∏–±–∫–∞ –ø—Ä–∏ .get())
    print("\nüìå map_async —Å –æ—à–∏–±–∫–æ–π:")
    try:
        with Pool(4) as pool:
            result_obj = pool.map_async(faulty_function, [1, 2, 3, 4, 5])
            # –î—Ä—É–≥–∏–µ –¥–µ–ª–∞...
            print("  –î–µ–ª–∞–µ–º —á—Ç–æ-—Ç–æ –µ—â–µ...")
            time.sleep(2)
            results = result_obj.get()  # –ó–¥–µ—Å—å —É–ø–∞–¥–µ—Ç
        print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {results}")
    except Exception as e:
        print(f"  ‚ùå –ü–æ–π–º–∞–ª–∏ –æ—à–∏–±–∫—É –ø—Ä–∏ .get(): {type(e).__name__}: {e}")

    print("\nüí° –ò–¢–û–ì: –æ—à–∏–±–∫–∏ –≤ –≤–æ—Ä–∫–µ—Ä–∞—Ö –≤—Å–ø–ª—ã–≤–∞—é—Ç –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å")


# =============================================================================
# –ß–ê–°–¢–¨ 10: –°–†–ê–í–ù–ï–ù–ò–ï POOL VS PROCESS
# =============================================================================

def demonstrate_pool_vs_process():
    """
    –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Pool –∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö Process.
    """
    print("\n" + "=" * 70)
    print("üî∑ –ü–†–ò–ú–ï–† 10: POOL vs PROCESS - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤")
    print("=" * 70)

    def worker(x):
        time.sleep(1)
        return x * x

    data = [1, 2, 3, 4]

    # Pool –ø–æ–¥—Ö–æ–¥
    print("\nüìå –ü–û–î–•–û–î 1: Pool")
    start = time.time()
    with Pool(4) as pool:
        results_pool = pool.map(worker, data)
    pool_time = time.time() - start
    print(f"  Pool results: {results_pool}")
    print(f"  –í—Ä–µ–º—è: {pool_time:.3f} —Å–µ–∫")

    # Process –ø–æ–¥—Ö–æ–¥
    print("\nüìå –ü–û–î–•–û–î 2: –û—Ç–¥–µ–ª—å–Ω—ã–µ Process")
    start = time.time()
    processes = []
    results_queue = Queue()

    def worker_with_queue(x, q):
        q.put(worker(x))

    for x in data:
        p = Process(target=worker_with_queue, args=(x, results_queue))
        processes.append(p)
        p.start()

    for p in processes:
        p.join()

    results_process = []
    while not results_queue.empty():
        results_process.append(results_queue.get())

    process_time = time.time() - start
    print(f"  Process results: {results_process}")
    print(f"  –í—Ä–µ–º—è: {process_time:.3f} —Å–µ–∫")

    """
    –°–†–ê–í–ù–ï–ù–ò–ï:

    POOL:
    + –ú–µ–Ω—å—à–µ –∫–æ–¥–∞
    + –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    + –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫
    + –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

    PROCESS:
    + –ì–∏–±–∫–æ—Å—Ç—å (–æ—á–µ—Ä–µ–¥–∏, –ø–∏–ø—ã)
    + –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–∞–∂–¥—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
    + –û–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
    """
    print("\nüí° –í–´–í–û–î:")
    print("  Pool - –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –∑–∞–¥–∞—á")
    print("  Process - –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–±—â–µ–Ω–∏–µ –∏–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å")


# =============================================================================
# –ß–ê–°–¢–¨ 11: –¢–ï–†–ú–ò–ù–û–õ–û–ì–ò–Ø (–®–ü–ê–†–ì–ê–õ–ö–ê)
# =============================================================================

"""
üìö –¢–ï–†–ú–ò–ù–û–õ–û–ì–ò–Ø MULTIPROCESSING.POOL
===============================================================================

–í–û–†–ö–ï–† (WORKER):
    –ü—Ä–æ—Ü–µ—Å—Å –≤ –ø—É–ª–µ, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á–∏. 
    –ê–Ω–∞–ª–æ–≥–∏—è: —Ä–∞–±–æ—á–∏–π —Å —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä–æ–º.

–ü–£–õ –ü–†–û–¶–ï–°–°–û–í (POOL):
    –ú–µ–Ω–µ–¥–∂–µ—Ä, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –≥—Ä—É–ø–ø–æ–π –≤–æ—Ä–∫–µ—Ä–æ–≤.
    –ê–Ω–∞–ª–æ–≥–∏—è: –±—Ä–∏–≥–∞–¥–∏—Ä —Å –∫–æ–º–∞–Ω–¥–æ–π —Ä–∞–±–æ—á–∏—Ö.

–†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ó–ê–î–ê–ß:
    –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞ —Å–≤–æ–±–æ–¥–Ω—ã–º –≤–æ—Ä–∫–µ—Ä–∞–º.

–ë–õ–û–ö–ò–†–£–Æ–©–ò–ô –í–´–ó–û–í:
    –†–æ–¥–∏—Ç–µ–ª—å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏ –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á.
    –ü—Ä–∏–º–µ—Ä: map()

–ù–ï–ë–õ–û–ö–ò–†–£–Æ–©–ò–ô –í–´–ó–û–í:
    –†–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–∑–∂–µ.
    –ü—Ä–∏–º–µ—Ä: map_async()

CHUNK SIZE:
    –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –≤–æ—Ä–∫–µ—Ä—É –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑.
    –ë–æ–ª—å—à–µ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–¥–∞—á, –º–µ–Ω—å—à–µ –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö.

INITIALIZER:
    –§—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º–∞—è –≤ –∫–∞–∂–¥–æ–º –≤–æ—Ä–∫–µ—Ä–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
    –î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

ASYNC RESULT:
    –û–±—ä–µ–∫—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.
    –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∏ –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
"""

# =============================================================================
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ó–ê–ü–£–°–ö–ê –ü–†–ò–ú–ï–†–û–í
# =============================================================================

if __name__ == '__main__':
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–º–µ—Ä–æ–≤.
    –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –Ω—É–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è.
    """
    a = "üî• –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –°–ü–†–ê–í–û–ß–ù–ò–ö –ü–û MULTIPROCESSING.POOL üî•"
    b = f"{'üî•' * (len(a) // 2 - 3)}"
    print(b)
    print(a)
    print(b)

    # –ü–æ–¥–≥–æ—Ç–æ–≤–∏–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
    prepare_test_file(lines=100_000, digits_per_line=3)

    # =======================================================================
    # –†–ê–°–ö–û–ú–ú–ï–ù–¢–ò–†–£–ô –ù–£–ñ–ù–´–ô –ü–†–ò–ú–ï–† –î–õ–Ø –ò–ó–£–ß–ï–ù–ò–Ø
    # =======================================================================

    # –ü—Ä–∏–º–µ—Ä 1: map - –±–ª–æ–∫–∏—Ä—É—é—â–∏–π, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫
    demonstrate_map()

    # –ü—Ä–∏–º–µ—Ä 2: map_async - –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π
    # demonstrate_map_async()

    # –ü—Ä–∏–º–µ—Ä 3: imap - –ª–µ–Ω–∏–≤—ã–π, –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å –ø–æ—Ä—è–¥–∫–æ–º
    # demonstrate_imap()

    # –ü—Ä–∏–º–µ—Ä 4: imap_unordered - –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–µ–∑ –ø–æ—Ä—è–¥–∫–∞
    # demonstrate_imap_unordered()

    # –ü—Ä–∏–º–µ—Ä 5: starmap - –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    # demonstrate_starmap()

    # –ü—Ä–∏–º–µ—Ä 6: —Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (close/join)
    # demonstrate_pool_management()

    # –ü—Ä–∏–º–µ—Ä 7: chunksize - —Ä–∞–∑–º–µ—Ä –ø–æ—Ä—Ü–∏–∏
    # demonstrate_chunksize()

    # –ü—Ä–∏–º–µ—Ä 8: initializer - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤
    # demonstrate_initializer()

    # –ü—Ä–∏–º–µ—Ä 9: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
    # demonstrate_error_handling()

    # –ü—Ä–∏–º–µ—Ä 10: Pool vs Process
    # demonstrate_pool_vs_process()

    print("\n‚úÖ –ú–æ–¥—É–ª—å –≥–æ—Ç–æ–≤ –∫ –∏–∑—É—á–µ–Ω–∏—é!")
    print("–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –Ω—É–∂–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –≤ –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞")

